# Практическое занятие — 15.09.2023
## Решение матричной ($2 \times 2$) игры

Общий вид матрицы:
$$
P = \begin{pmatrix}
	a_{11} & a_{12} \\
	a_{21} & a_{22}
\end{pmatrix}
$$
Пусть нижняя цена игры меньше верхней цены игры: $\underline{v} < \overline{v}$. Задача должна быть решена в классе смешанных стратегий.

Векторы смешанных стратегий для:
1. Игрок А: $x = (p_1, p_2) = (p, 1 - p)$, $p_1 = p$, $p_2 = 1 - p$, $0 \le p \le 1$. Если $p = 1$, то выбирается стратегия $A_{1}$, если $p = 0$, то $A_{2}$.
2. Игрок Б: $y = (q_1, q_2) = (q, 1 - q)$, $q_1 = p$, $q_2 = 1 - p$, $0 \le q \le 1$. Если $q = 1$, то выбирается стратегия $B_{1}$, если $q = 0$, то $B_{2}$.

Из свойств оптимальных смешанных стратегий (а именно, из свойства №1), следует, что если $p \ne 1$ и $p \ne 0$, то $v = H_{A}(i, y*), i = \overline{1, m}$
Если $q_{j}^{*} > 0$, то $v = H_{A}(x^{*}, j), j = \overline{1, n} \implies$
$$
\begin{cases}
v = H_{A}(x^{*}, 1) \\
v = H_{A}(x^{*}, 2)
\end{cases}
$$
$x^{*}$ — вектор оптимальной смешанной стратегии, определяется числом $p$: $x^{*} = (p^{*}, 1 - p^{*})$. Таким образом, можем записать:
$$\begin{cases}
v = H_{A}(p^{*}, 1) \\
v = H_{A}(p^{*}, 2)
\end{cases}$$
$\implies H_{A}(p, 1) = H_{A}(p, 2) = v, p=p^{*}$

$$H_{A}(p, j) = (p, 1 - p) * \begin{pmatrix}
	a_{11} & a_{12} \\
	a_{21} & a_{22}
\end{pmatrix} * [ \begin{pmatrix} 1 \\ 0 \end{pmatrix} \text{ или } \begin{pmatrix} 0 \\ 1 \end{pmatrix}]
$$
$H_{A}(p, 1) = a_{11} p + a_{21} (1 - p)$
$H_{A}(p, 2) = a_{12}p + a_{22} (1 - p)$
$a_{11} p + a_{21} (1 - p) = a_{12} p + a_{22} (1 - p) = u$, $p = p^{*}$
$p^{*} = \frac{a_{22} - a_{21}}{a_{11} + a_{22} - a_{12} - a_{21}}$, $v = \frac{a_{22} a_{11} - a_{12} a_{21}}{a_{11} + a_{22} - a_{12} - a_{21}}$

Выше мы получили **решение для игрока А**. Найдем теперь решение для игрока Б.
Будем действовать аналогично, исходя из свойства №1 оптимальных смешанных стратегий.

$v = H_{A}(i, y^{*}) = H_{A}(i, q_{*})$, $\forall i = \overline{1, m}$, $m = 2$
$$
\begin{cases}
v = H_{A}(1, q), \ q = q^{*} \\
v = H_{A}(2, q)
\end{cases}
$$
$H_{A} = (1, q) = (a_{11}, a_{12}) \begin{pmatrix} q \\ 1 - q \end{pmatrix} = a_{11} q + a_{12} (1 - q)$
$H_{A}(2, q) = (a_{21}, a_{22}) \begin{pmatrix} q \\ 1 - q \end{pmatrix} = a_{21} q + a_{22} (1 - q)$
Отсюда:
$a_{11} q + a_{12} (1 - q) = a_{21} q + a_{22} (1 - q) = v$, $q = q^{*}$
$q^{*} = \frac{a_{22} - a_{12}}{a_{11} + a_{22} - a_{12} - a_{21}}$

### Примеры
#### Пример №1

$$
P = \begin{pmatrix} 1 & -1 \\ -1 & 1 \end{pmatrix}
$$
$x = (p, 1 - p)$, $y = (q, 1 - q)$
$y = -1$, $\overline{v} = 1 \implies -1 \le v \le 1$. Ситуации равновесия в чистых стратегиях для данной игры не существует.

**Найдем решение для игрока А**:
$$
\begin{cases}
v = p + (-1)(1 - p) \\
v = (-1) * p + (1 - p), \ p = p^{*}
\end{cases}
$$
Отсюда:
$p - (1 - p) = p + 1 - p = v \implies 2 p - 1 = 1 - 2p = v, p = p^{*}$
$\implies p^{*} = \frac{2}{4} = \frac{1}{2}$. Найдем средний выигрыш: $v = 2 * \frac{1}{2} = 0$.
$x^{*} = (\frac{1}{2}; \frac{1}{2})$
Таким образом, игрок А должен чередовать свои стратегии, чтобы его средний выигрыш был равен нулю.

**Найдем решение для игрока Б**:
$$
\begin{cases}
v = q + -1 * (1 - q) \\
v = -q + (1 - q), \ q = q^{*}
\end{cases}
$$
Отсюда: $q - 1 + q = -q + 1 - q = v, q = q^{*} \implies q^{*} = \frac{1}{2}$
$y^{*} = (\frac{1}{2}; \frac{1}{2})$
#### Пример №2

$$
P = \begin{pmatrix} -3 & 1 \\ 5 & -7 \end{pmatrix}
$$
Проверим, существуют ли решения в чистых стратегиях, для этого найдем $\underline{v} = max \{-3; -7\} = -3$, $\overline{v} = max \{5 ; 1 \} = 1$. Отсюда: $-3 < v < 1$
$x = (p, 1 - p)$, $y = (q, 1 - q)$ — стратегии игроков А и Б.

**Решение для игрока А:** $(-3) p + 5 (1 - p) = 1 * p + (-7)(1 - p) = v$, $p = p^{*} \implies 5 - 8p = 8p - 7 = v \implies p^{*} = \frac{12}{16} = \frac{3}{4} \implies x^{*} = (\frac{3}{4}; \frac{1}{4})$. Цена игры: $v = 5 - 8 * \frac{3}{4} = -1$ — средний выигрыш отрицателен.

**Решение для игрока А**. Вместо столбцов матрицы составляем элементарные комбинации строк: $(-3)q + 1(1 - q) = 5q - 7(1 - q) = v, q = q^{*} \implies$
$\implies -4q + 1 = 12q - 7 \implies q^{*} = \frac{8}{16} = \frac{1}{2}$.
$y^{*} = (\frac{1}{2}; \frac{1}{2})$. Цена игры никак не поменялась: $v = -4 * \frac{1}{2} + 1 = -1$, все еще отрицательное.
### Некоторые размышления

К сожалению, эти чрезвычайно простые решения $2 \times 2$ матричных игр невозможно перенести на матричные игры большей размерности.
В общем случае мы получаем неравенства. Просто так записать, что что-то равно, мы уже не способны.
Сложность состоит в том, что мы не знаем, все ли стратегии смешаны.
Другой подход к решению игр — геометрический.
### Геометрическая интерпретация решения матричной $(2 \times 2)$ игры

Пусть имеем матрицу
$$P = \begin{pmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22}
\end{pmatrix}$$
Нам ее необходимо перенести на плоскость $XoY$. На ней отложим единичный отрезок.

$x = 0: A_{1}$, $x = 1: A_{2}$

Отложим точки $a_{11}$, $a_{12}$, $a_{21}, a_{22}$. Построим отрезки, их соединяющие.

Точка пересечения этих двух линий, $M$ — это решение задачи.

$M(x^{*}, y^{*}) \implies x^{*} = 1 - p^{*}, y^{*} = u$.
$max_{p} min_{j} H_{A} (p, j) = v$

$B_{1}B_{1}: \frac{x - 0}{1 - 0} = \frac{y - a_{11}}{a_{21} - a_{11}} = x$
$B_2B_2: \frac{x - 0}{1 - 0} = \frac{y - a_{12}}{a_{22} - a_{12}} = x$

Из этих уравнений находим точку пересечения $M$.

Это есть решение для игрока А. *Примечание: на рисунке преподавателя точка $M$ лежит на оси $OX$. Но у меня на скорую руку получилось иначе.*

![[Pasted image 20230915122111.png]]

**Решение для игрока Б строится симметрично решению для игрока А**.

$x = 0: B_1$, $x = 1: B_2$

Откладывать нужно числа, лежащие в столбцах: на первой оси $a_{11}, a_{21}$, на второй оси $a_{12}, a_{22}$. Таким же образом соединим их точки, их пересечение обозначим как $N$.

$N(x^{*}, y^{*})$, $x^{*} = 1 - q$, $y^{*} = u$.
$min_{q} max_{i} H_{A}(i, q) = v$

$A_{1}A_{1}: \frac{x - 0}{1 - 0} = \frac{y - a_{11}}{a_{12} - a{11}} = x$
$A_{2}A_{2} = \frac{x - 0}{1 - 0} = \frac{y-a_{21}}{a_{22} - a_{21}} = x$
$\frac{y - a_{11}}{a_{12} - a{11}} = \frac{y-a_{21}}{a_{22} - a_{21}} = x^{*}$

Из этих уравнений находим точку пересечения $M$.

**Этот способ решения применим лишь для чистых стратегий.**

Также возможен следующий случай:
![[Pasted image 20230915122749.png]]

#### Примеры
##### Пример №1

$$
P = \begin{pmatrix} -3 & 1 \\ 5 & -7 \end{pmatrix}
$$

**Решение для игрока А**:

![[Pasted image 20230915123616.png]]

$B_1B_1: x = \frac{y - (-3)}{5 - (-3)}$
$B_2B_2: x = \frac{y-1}{-7-1}$
Найдем решение, для этого приравняем оба уравнения: $\frac{y+3}{8}=\frac{y-1}{-8}$, $y = y^{*} = v$
Получим: $-8y - 24 = 8y - 8$, $y=y^{*}$, $y^{*} = -\frac{16}{16} = -1$
$x^{*} = \frac{y^{*} + 1}{8} = \frac{-1 + 3}{8} = \frac{1}{4} = q - p^{*} \implies p^{*} = \frac{3}{4}$
$x = (\frac{3}{4}; \frac{1}{4})$, $v = -1$

**Решение для игрока Б**:

![[Pasted image 20230915123956.png]]

$A_1A_1: x = \frac{y-(-3)}{1-(-3)}$
$A_2A_2: x = \frac{y-5}{-7-5}$
$14x = y+3$, $-12x = y-5 \implies y = 4x - 3$, $y = 5 - 12x \implies$ $4x - 3 = 5 - 12x$, $x = x^{*}$
$16x = 8 \implies x^{*} = \frac{8}{16} = \frac{1}{2} = 1 - q^{*} \implies y = (\frac{1}{2}; \frac{1}{2})$
$v = y^{*} = 4x^{*} - 3 = 4 * \frac{1}{2} - 3 = -1$

### Решение матричных игр размерности $(2 \times n)$

Геометрический подход к решению игры $2 \times 2$ может быть обобщен на решение матричных игр размерности $(2 \times n)$ и $(n \times 2)$

Пусть 
$$
P = \begin{pmatrix}
	a_{11} & a_{12} & \dots & a_{1n} \\
	a_{21} & a_{22} & \dots & a_{2n}
\end{pmatrix}
$$
Игрок А по-прежнему имеет две стратегии, а игрок Б имеет $n$ стратегий.

Стратегия игрока А: $x = (p, 1 - p)$, $0 \le p \le 1$
Стратегия игрока Б: $y = (q_1, q_2, \dots q_{n})$, $0 \le q_{j} \le 1$, $\sum\limits_{j=1}^{n} q_{j} = 1$

Воспользуемся первым свойством оптимальных смешанных стратегий:
$v = min_{j} H_{A}(p^{*}, j) = max_{p} min_{j} H_{A}(p, j)$
$H_{A}(p, j) = a_{1 j} p + a_{2j} (1 - p)$

**Для геометрического решения необходимо построить графики этих функций** $H_{A}(p, j)$
Рисуем линии $v = H_{A}(p, j)$, $j = \overline{1, n}$ на плоскости $VoP$. У нас будет не две линии, а может быть сколько угодно: три, четыре, пять, двадцать...
