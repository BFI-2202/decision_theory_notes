# Лекция — 11.09.2023

Укажем **принципы оптимальности для игроков матричной игры**.
**Решение игры**:
* Игрок А: если он выбрал стратегию $A_{i}$, то игрок Б выберет такую стратегию $B_{j}$, для которой выигрыш игрока А будет минимальным: $min \ a_{i j}$ ($1 \le j \le n$), далее игрок А максимизирует свой выигрыш по всем своим стратегиям $max \ min \ a_{i j}$ ($1 \le i \le m1 \le j \le n$) = $\underline{v}$ (**максимин** или нижняя цена игры — гарантированный выигрыш игрока А). Принцип выбора игроком А своей стратегии, основанный на максимизации минимального выигрыша, называют принципом максимина, а соответствующую стратегию максиминной. 
* Игрок Б: пусть он выбрал стратегию $B_{j}$, тогда А выбирает такую стратегию $A_{i}$, при которой выигрыш игрока А максимальный: $max \ a_{i j}$ ($1 \le i \le m$). После этого игрок Б может гарантировать себе минимальный проигрыш, который будет равен $min \ max \ a_{i j}$ ($1 \le j \le n 1 \le i \le m$) = $\overline{v}$ (**минимакс** или верхняя цена игры — минимальный проигрыш игрока Б)

**Цена игры** $v_{A}$ — средний выигрыш игрока А. В любой матричной игре всегда выполняется следующее неравенство:
$$\underline{v} \le v_{A} \le \overline{v}$$
Лемма. $\underline{v} \le \overline{v}$
Доказательство. $a_{i j} \le max \ a_{ij}$ ($1 \le i \le m$) $\implies$ $min \ a_{i j} \ (1 \le j \le n) \le min \ max \ a_{i j} = \overline{v}$
$\underline{v} = max \ min \ a_{i j} \implies \underline{v} \le \overline{v}$

## Ситуация равновесия в матричной ($m \times n$) игре

Ситуацией равновесия в матричной игре называется такая ситуация, от которой невыгодно отклоняться каждому из игроков. Обозначим ситуацию равновесия таким образом: $(A_{i}^{*}, B_{i}^{*})$ или $(i^{*}, j^{*})$.
Ситуация называется равновесной (или седловой точкой), если одновременно выполняется следующее:
$$a_{i j^{*}} \le a_{i^{*} j^{*}}$$
$$a_{i^{*} j} \ge a_{i^{*} j^{*}}$$
$a_{i^{*} j^{*}} = v_{A}^{*}$ — выигрыш игрока A в ситуации $(i^{*}, j^{*})$
В ситуации равновесия: $v^{*} = \underline{v} = \overline{v}$. Если это равенство выполняется, то говорят, что игра имеет решение в чистых стратегиях. **Соответствующие максиминные и минимаксные стратегии игроков А и Б называются равновесными или оптимальными**.
Матричная игра может иметь или одну ситуацию равновесия, или несколько ситуаций равновесия, либо не иметь ни одной.
Если $(i_{1}^{*}, j_{1}^{*})$ и $(i_{2}^{*}, j_{2}^{*})$ — ситуации равновесия, то ситуации $(i_{1}^{*}, j_{2}^{*})$ и $(i_{2}^{*}, j_{1}^{*})$ также являются равновесными.

Пример:
$P = \begin{pmatrix} -5 & 3 & 1 & 20 & 3 \\ 5 & 5 & 4 & 6 & 4 \\ -4 & -2 & 0 & 0 & 2\end{pmatrix}$
Найти ситуацию равновесия. Найдем максимин и минимакс:
$\underline{v} = max \ \{ -5, 4, -4 \} = 4 \implies A_2$ — оптимальная стратегия
$\overline{v} = min \ \{ 5, 5, 4, 20, 4\} = 4 \implies B_{3}, B_{5}$ — оптимальные стратегии
Максимин равен минимаксу, следовательно, в игре есть ситуация равновесия.  И их две: $(A_{2}, B_{3})$ и $(A_{2}, B_{5})$ — ситуации равновесия.

## Смешанной расширение матричной игры

Смешанное расширение игры рассматривается в том случае, если $\underline{v} \le \overline{v}$.
В этом случае игрокам следует выбирать свои стратегии случайным образом. При этом не сообщая об этом противнику.

Случайная величина, значение которой является стратегией (ее номером) игроков, называется **смешанной стратегией**.

Зададим смешанные стратегии для матричной $(m \times n)$ игры.
Смешанной стратегией $x$ игрока А называется вектор: $x = (p_1, p_2, \dots, p_m)$, $0 \le p_i \le 1$, $\sum\limits_{i = 1}^{m} p_i = 1$, $p_i$ — вероятность выбора игроком $A_{i}$-ой стратегии.
Смешанной стратегией $y$ игрока А называется вектор: $y = (q_1, q_2, \dots, q_n)$, $0 \le q_i \le 1$, $\sum\limits_{j = 1}^{n} q_j = 1$, $q_j$ — вероятность выбора игроком $B_{j}$-ой стратегии.

Найдем выигрыш игрока А в ситуации $(x, y)$. В ситуации $(A_{i}, B_{j})$ выигрыш составляет $a_{i j} \implies a_{i j} p_{i} q_{j}$. Средний выигрыш будет равен:
$$H_{A} (x, y) = \sum\limits_{i = 1}^{m} \sum\limits_{j = 1}^{n} a_{i j} p_{i} q_{j} = x * P * y^{T}$$
Ситуацией ($x^{*}, y^{*}$) называется ситуация равновесия в смешанных стратегиях, а $x^{*}$ и $y^{*}$ — оптимальные (равновесные) смешанные стратегии игроков А и Б, если для всех $x$, $y$:
$$H_{A}(x, y) \le H_{A}(x^{*}, y^{*}) \le H_{A}(x^{*}, y)$$
Тогда цена игры $v_{A} = v^{*} = H_{A} (x^{*}, y^{*})$
Приведенной определение означает, что:
* $v_{A} = max_x \ min_y \ H_{A} (x, y) = min_y \ max_x \ H_{A} (x, y)$

### Основные теоремы теории игр

**Теорема (Джон фон Нейман)**: любая матричная игра имеет решение в смешанных стратегиях.
* Игрок А выбрал $i$-ую стратегию: $x^{(i)} = (i) = \{ 0, \dots, 0, 1, 0, \dots, 0 \}$
* То же самое для игрока Б

### Основные свойства оптимальных смешанных стратегий

1. Пусть $x^{*} = (p_1^{*}, \dots, p_m^{*})$ и $y^{*} = (q_1^{*}, \dots, q_n^{*})$ — оптимальные смешанные стратегии игроков А и Б, $v = H_{A}(x^{*}, y^{*})$ — цена игры. Тогда оптимальная смешанная стратегия $x^{*}$ игрока А (и аналогично для игрока Б) смешивается только из таких его чистых стратегий $A_{i}$, то есть отличны от нуля те вероятности $p_{i}$ те вероятности, для которых:
   $$v = H_{A}(i, y^{*}) = \sum\limits_{j = 1}^{n} a_{i j} q_{j}^{*}$$
   Оптимальная смешанная стратегия $y^{*}$ игрока Б смешивается из таких $B_{j}$, то есть отличны от нуля такие вероятности $q_{j}$, для которых:
   $$v = H_{A}(x^{*}, j) = \sum\limits_{i = 1}^{m} a_{i j} p_{i}^{*}$$
2. Для того, чтобы $(x^{*}, y^{*})$ была ситуацией равновесия, а $v = H_{A}(x^{*}, y^{*})$ — ценой игры, необходимо и достаточно, чтобы для любых $i=\overline{1, m}$, $j = \overline{1, n}$:   $$H_{A}(i, y^{*}) \le v \le H_{A}(x^{*}, j)$$
2. Для того, чтобы $(x^{*}, y^{*})$ была ситуацией равновесия, а $v = H_{A}(x^{*}, y^{*})$ — ценой игры, необходимо и достаточно, чтобы:   $$max_{i} H_{A}(i, y^{*}) = min_{j} H_{A} (x^{*}, j)$$
   или
   $$max_{i} min_{j} H_{a}(i, y) = min_{j} max_{x} H_{A}(x, j)$$
4. В матричной игре множества оптимальных смешанных стратегий игроков являются выпуклыми многогранниками (многоугольниками).
5. Пусть платежная матрица $P=(a_{i j})_{n \times n}$  является кососимметрической, то есть $a_{i j} = - a_{j i} (\forall i \ne j)$. Тогда оптимальные смешанные стратегии игроков А и Б совпадают: $x^{*}=y^{*}$ и цена игры равна нулю: $v^{*} = 0$